// ===============================
// FOCUS AREA: WEB PROGRAMMING - CHAPTER 2
// Server-Side Scripting and Client-Side Interactivity
// Based on Ministry of Education Blueprint (2 Questions: Apply)
// File Path: FocusAreaOfExitExam/web-programming/chapter2.js
// ===============================

(function() {
    console.log("üöÄ Chapter 2 script is executing...");
    console.log("Timestamp:", new Date().toISOString());

    window.focusAreaWebChapter2 = {
        title: "Chapter 2: Server-Side Scripting and Client-Side Interactivity",
        
        description: "Practical application of server-side scripting languages and implementation of client-side interactivity using JavaScript and related technologies.",
        
        blueprint: {
            totalQuestions: 2,
            cognitiveLevels: {
                apply: 2
            },
            topics: [
                "Server-side scripting languages (PHP, Node.js, Python, etc.)",
                "Client-side interactivity with JavaScript",
                "Form handling and validation",
                "AJAX and asynchronous requests",
                "Session management and cookies",
                "Event handling and DOM manipulation"
            ]
        },

        learningObjectives: [
            "Apply server-side scripting languages to create dynamic web content",
            "Implement client-side interactivity using JavaScript",
            "Handle and validate form data on both client and server sides",
            "Use AJAX for asynchronous communication with servers",
            "Manage user sessions and cookies for state maintenance",
            "Manipulate the DOM in response to user events"
        ],

        sections: [
            {
                title: "2.1 Server-Side Scripting Languages",
                content: "<div><h4>What is Server-Side Scripting?</h4><p>Server-side scripting involves running scripts on the web server to generate dynamic content before sending it to the client's browser. The server processes the script, interacts with databases, and returns HTML to the client.</p><div class='key-points-box'><p><strong>üîë Key Point:</strong> Server-side code is executed on the server, and only the output (usually HTML) is sent to the client. The source code remains hidden from users.</p></div><h4>Popular Server-Side Languages</h4><table style='width:100%; border-collapse: collapse; margin:15px 0;'><tr style='background-color:#2772a0; color:white;'><th style='padding:10px; border:1px solid #ddd;'>Language</th><th style='padding:10px; border:1px solid #ddd;'>Characteristics</th><th style='padding:10px; border:1px solid #ddd;'>Common Use Cases</th><th style='padding:10px; border:1px solid #ddd;'>Example Framework</th></tr><tr><td style='padding:8px; border:1px solid #ddd;'><strong>PHP</strong></td><td style='padding:8px; border:1px solid #ddd;'>Easy to learn, widely supported, embedded in HTML</td><td style='padding:8px; border:1px solid #ddd;'>WordPress, e-commerce, content management</td><td style='padding:8px; border:1px solid #ddd;'>Laravel, Symfony</td></tr><tr><td style='padding:8px; border:1px solid #ddd;'><strong>Node.js</strong></td><td style='padding:8px; border:1px solid #ddd;'>JavaScript on server, event-driven, non-blocking I/O</td><td style='padding:8px; border:1px solid #ddd;'>Real-time apps, APIs, microservices</td><td style='padding:8px; border:1px solid #ddd;'>Express.js</td></tr><tr><td style='padding:8px; border:1px solid #ddd;'><strong>Python</strong></td><td style='padding:8px; border:1px solid #ddd;'>Readable, versatile, extensive libraries</td><td style='padding:8px; border:1px solid #ddd;'>Data-driven apps, scientific web apps</td><td style='padding:8px; border:1px solid #ddd;'>Django, Flask</td></tr><tr><td style='padding:8px; border:1px solid #ddd;'><strong>Java</strong></td><td style='padding:8px; border:1px solid #ddd;'>Robust, scalable, enterprise-grade</td><td style='padding:8px; border:1px solid #ddd;'>Large enterprise applications</td><td style='padding:8px; border:1px solid #ddd;'>Spring, Java EE</td></tr><tr><td style='padding:8px; border:1px solid #ddd;'><strong>Ruby</strong></td><td style='padding:8px; border:1px solid #ddd;'>Elegant syntax, convention over configuration</td><td style='padding:8px; border:1px solid #ddd;'>Startups, rapid development</td><td style='padding:8px; border:1px solid #ddd;'>Ruby on Rails</td></tr><tr><td style='padding:8px; border:1px solid #ddd;'><strong>C# (ASP.NET)</strong></td><td style='padding:8px; border:1px solid #ddd;'>Microsoft ecosystem, strong typing</td><td style='padding:8px; border:1px solid #ddd;'>Windows-based enterprise apps</td><td style='padding:8px; border:1px solid #ddd;'>ASP.NET Core</td></tr></table><h4>PHP Example: Simple Dynamic Page</h4><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;User Profile&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;h1&gt;Welcome, &lt;?php echo $_GET['name'] ?? 'Guest'; ?&gt;!&lt;/h1&gt;\n    \n    &lt;?php\n    // Database connection\n    $conn = new mysqli('localhost', 'username', 'password', 'mydb');\n    \n    if ($conn->connect_error) {\n        die(\"Connection failed: \" . $conn->connect_error);\n    }\n    \n    $sql = \"SELECT * FROM products WHERE category = 'electronics'\";\n    $result = $conn->query($sql);\n    \n    if ($result->num_rows > 0) {\n        echo \"&lt;ul&gt;\";\n        while($row = $result->fetch_assoc()) {\n            echo \"&lt;li&gt;\" . $row['name'] . \" - $\" . $row['price'] . \"&lt;/li&gt;\";\n        }\n        echo \"&lt;/ul&gt;\";\n    } else {\n        echo \"&lt;p&gt;No products found&lt;/p&gt;\";\n    }\n    \n    $conn->close();\n    ?&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre><h4>Node.js Example: Simple Server</h4><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>const express = require('express');\nconst app = express();\nconst port = 3000;\n\n// Middleware to parse JSON\napp.use(express.json());\n\n// Route handler\napp.get('/api/users/:id', (req, res) => {\n    const userId = req.params.id;\n    \n    // Simulate database lookup\n    const user = {\n        id: userId,\n        name: 'John Doe',\n        email: 'john@example.com'\n    };\n    \n    res.json(user);\n});\n\n// Handle POST request\napp.post('/api/users', (req, res) => {\n    const newUser = req.body;\n    // Save to database...\n    res.status(201).json({ message: 'User created', user: newUser });\n});\n\napp.listen(port, () => {\n    console.log(`Server running at http://localhost:${port}`);\n});</pre><h4>Python (Flask) Example</h4><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>from flask import Flask, render_template, request, redirect, url_for, session\nimport sqlite3\n\napp = Flask(__name__)\napp.secret_key = 'your-secret-key'\n\n@app.route('/')\ndef index():\n    if 'username' in session:\n        return f'Logged in as {session[\"username\"]}'\n    return 'You are not logged in'\n\n@app.route('/login', methods=['GET', 'POST'])\ndef login():\n    if request.method == 'POST':\n        username = request.form['username']\n        password = request.form['password']\n        \n        # Validate credentials\n        conn = sqlite3.connect('users.db')\n        cursor = conn.cursor()\n        cursor.execute(\"SELECT * FROM users WHERE username=? AND password=?\", \n                      (username, password))\n        user = cursor.fetchone()\n        conn.close()\n        \n        if user:\n            session['username'] = username\n            return redirect(url_for('index'))\n        else:\n            return 'Invalid credentials'\n    \n    return render_template('login.html')\n\nif __name__ == '__main__':\n    app.run(debug=True)</pre></div>",
                keyPoints: [
                    "Server-side code runs on server, not visible to clients",
                    "Common languages: PHP, Node.js, Python, Java, Ruby, C#",
                    "PHP is embedded in HTML with <?php ?> tags",
                    "Node.js uses JavaScript on server with event-driven model",
                    "Server-side handles database operations, authentication, business logic"
                ]
            },

            {
                title: "2.2 Client-Side Interactivity with JavaScript",
                content: "<div><h4>What is Client-Side Interactivity?</h4><p>Client-side interactivity refers to dynamic behavior implemented in the browser using JavaScript. It allows web pages to respond to user actions without communicating with the server.</p><div class='key-points-box'><p><strong>üîë Key Point:</strong> Client-side code runs in the user's browser and can respond immediately to user actions, providing a smooth, responsive experience.</p></div><h4>JavaScript Fundamentals</h4><h5>Variables and Data Types</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>// Variable declarations\nlet name = 'John';           // String (block-scoped)\nconst PI = 3.14;             // Constant\nvar oldWay = 'Avoid this';   // Function-scoped\n\n// Data types\nlet number = 42;              // Number\nlet text = \"Hello\";           // String\nlet isActive = true;          // Boolean\nlet items = [1, 2, 3];        // Array\nlet person = {                 // Object\n    name: 'John',\n    age: 30\n};</pre><h5>Functions</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>// Function declaration\nfunction add(a, b) {\n    return a + b;\n}\n\n// Function expression\nconst multiply = function(a, b) {\n    return a * b;\n};\n\n// Arrow function (ES6+)\nconst subtract = (a, b) => a - b;\n\n// Callback function\nfunction processUserInput(callback) {\n    const name = prompt('Enter your name:');\n    callback(name);\n}\n\nprocessUserInput((name) => {\n    console.log('Hello, ' + name);\n});</pre><h5>DOM Manipulation</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>// Selecting elements\nconst header = document.getElementById('header');\nconst buttons = document.getElementsByClassName('btn');\nconst firstButton = document.querySelector('.btn');\nconst allButtons = document.querySelectorAll('.btn');\n\n// Modifying content\nheader.textContent = 'New Title';\nheader.innerHTML = '<span>New Content</span>';\n\n// Modifying styles\nheader.style.color = 'blue';\nheader.style.backgroundColor = 'yellow';\nheader.classList.add('highlight');\nheader.classList.remove('old-class');\nheader.classList.toggle('active');\n\n// Creating elements\nconst newDiv = document.createElement('div');\nnewDiv.textContent = 'I am new!';\ndocument.body.appendChild(newDiv);\n\n// Removing elements\nconst oldElement = document.getElementById('old');\noldElement.remove();</pre><h5>Event Handling</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>// Method 1: Inline (not recommended)\n&lt;button onclick=\"alert('Clicked!')\"&gt;Click Me&lt;/button&gt;\n\n// Method 2: Property assignment\nconst btn = document.getElementById('myButton');\nbtn.onclick = function() {\n    alert('Button clicked!');\n};\n\n// Method 3: addEventListener (recommended)\nconst btn2 = document.getElementById('myButton2');\nbtn2.addEventListener('click', function(event) {\n    console.log('Button clicked', event);\n    event.preventDefault(); // Prevent default behavior\n});\n\n// Common events\nelement.addEventListener('click', handler);      // Mouse click\nelement.addEventListener('mouseover', handler);  // Mouse enters\nelement.addEventListener('mouseout', handler);   // Mouse leaves\nelement.addEventListener('keydown', handler);    // Key pressed\nelement.addEventListener('submit', handler);     // Form submitted\nelement.addEventListener('change', handler);     // Input changed\nelement.addEventListener('load', handler);       // Page loaded</pre></div>",
                keyPoints: [
                    "Client-side code runs in browser, enables instant interactivity",
                    "JavaScript is the primary language for client-side scripting",
                    "DOM manipulation allows dynamic updates to page content",
                    "Event listeners respond to user actions (click, mouseover, keypress, etc.)",
                    "Modern JS uses let/const, arrow functions, and template literals"
                ]
            },

            {
                title: "2.3 Form Handling and Validation",
                content: "<div><h4>Form Handling Overview</h4><p>Forms are the primary way users input data on websites. Proper form handling involves both client-side validation (for user experience) and server-side validation (for security).</p><h4>Client-Side Form Validation</h4><h5>HTML5 Built-in Validation</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>&lt;form id=\"registrationForm\"&gt;\n    &lt;label&gt;Name:&lt;/label&gt;\n    &lt;input type=\"text\" name=\"name\" required minlength=\"2\"&gt;\n    \n    &lt;label&gt;Email:&lt;/label&gt;\n    &lt;input type=\"email\" name=\"email\" required&gt;\n    \n    &lt;label&gt;Age:&lt;/label&gt;\n    &lt;input type=\"number\" name=\"age\" min=\"18\" max=\"100\" required&gt;\n    \n    &lt;label&gt;Password:&lt;/label&gt;\n    &lt;input type=\"password\" name=\"password\" required pattern=\"(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{8,}\"&gt;\n    \n    &lt;label&gt;Website:&lt;/label&gt;\n    &lt;input type=\"url\" name=\"website\"&gt;\n    \n    &lt;button type=\"submit\"&gt;Register&lt;/button&gt;\n&lt;/form&gt;</pre><h5>JavaScript Validation</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>document.getElementById('registrationForm').addEventListener('submit', function(event) {\n    event.preventDefault(); // Prevent form submission\n    \n    const name = document.querySelector('input[name=\"name\"]').value;\n    const email = document.querySelector('input[name=\"email\"]').value;\n    const age = document.querySelector('input[name=\"age\"]').value;\n    const password = document.querySelector('input[name=\"password\"]').value;\n    \n    let errors = [];\n    \n    // Name validation\n    if (name.length < 2) {\n        errors.push('Name must be at least 2 characters');\n    }\n    \n    // Email validation\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(email)) {\n        errors.push('Please enter a valid email address');\n    }\n    \n    // Age validation\n    if (age < 18 || age > 100) {\n        errors.push('Age must be between 18 and 100');\n    }\n    \n    // Password validation\n    const passwordRegex = /^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/;\n    if (!passwordRegex.test(password)) {\n        errors.push('Password must be at least 8 characters with uppercase, lowercase, and number');\n    }\n    \n    // Display errors or submit\n    const errorDiv = document.getElementById('errors');\n    if (errors.length > 0) {\n        errorDiv.innerHTML = errors.map(err => '&lt;p&gt;' + err + '&lt;/p&gt;').join('');\n    } else {\n        // Submit via AJAX\n        submitFormViaAjax();\n    }\n});\n\nfunction submitFormViaAjax() {\n    const formData = new FormData(document.getElementById('registrationForm'));\n    \n    fetch('/api/register', {\n        method: 'POST',\n        body: formData\n    })\n    .then(response => response.json())\n    .then(data => {\n        if (data.success) {\n            alert('Registration successful!');\n            window.location.href = '/welcome';\n        } else {\n            alert('Registration failed: ' + data.message);\n        }\n    })\n    .catch(error => {\n        console.error('Error:', error);\n        alert('An error occurred. Please try again.');\n    });\n}</pre><h5>Server-Side Validation (PHP Example)</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>&lt;?php\n// process-registration.php\nif ($_SERVER['REQUEST_METHOD'] === 'POST') {\n    $errors = [];\n    \n    // Sanitize inputs\n    $name = filter_input(INPUT_POST, 'name', FILTER_SANITIZE_STRING);\n    $email = filter_input(INPUT_POST, 'email', FILTER_SANITIZE_EMAIL);\n    $age = filter_input(INPUT_POST, 'age', FILTER_VALIDATE_INT);\n    $password = $_POST['password'];\n    \n    // Validate\n    if (strlen($name) < 2) {\n        $errors[] = 'Name must be at least 2 characters';\n    }\n    \n    if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n        $errors[] = 'Invalid email format';\n    }\n    \n    if (!$age || $age < 18 || $age > 100) {\n        $errors[] = 'Age must be between 18 and 100';\n    }\n    \n    if (!preg_match('/^(?=.*\\d)(?=.*[a-z])(?=.*[A-Z]).{8,}$/', $password)) {\n        $errors[] = 'Password must be at least 8 characters with uppercase, lowercase, and number';\n    }\n    \n    // Check if email already exists\n    $pdo = new PDO('mysql:host=localhost;dbname=mydb', 'user', 'password');\n    $stmt = $pdo->prepare('SELECT id FROM users WHERE email = ?');\n    $stmt->execute([$email]);\n    \n    if ($stmt->fetch()) {\n        $errors[] = 'Email already registered';\n    }\n    \n    if (empty($errors)) {\n        // Hash password and save user\n        $hashedPassword = password_hash($password, PASSWORD_DEFAULT);\n        $stmt = $pdo->prepare('INSERT INTO users (name, email, age, password) VALUES (?, ?, ?, ?)');\n        \n        if ($stmt->execute([$name, $email, $age, $hashedPassword])) {\n            echo json_encode(['success' => true, 'message' => 'Registration successful']);\n        } else {\n            echo json_encode(['success' => false, 'message' => 'Database error']);\n        }\n    } else {\n        echo json_encode(['success' => false, 'errors' => $errors]);\n    }\n}\n?&gt;</pre><div class='key-points-box'><p><strong>üîë Important:</strong> Always validate on the server side! Client-side validation can be bypassed. Server-side validation is essential for security.</p></div></div>",
                keyPoints: [
                    "Client-side validation improves user experience but can be bypassed",
                    "HTML5 provides built-in validation (required, pattern, min, max, type)",
                    "JavaScript enables custom validation logic and real-time feedback",
                    "Server-side validation is mandatory for security",
                    "Always sanitize user inputs to prevent XSS and SQL injection"
                ]
            },

            {
                title: "2.4 AJAX and Asynchronous Requests",
                content: "<div><h4>What is AJAX?</h4><p>AJAX (Asynchronous JavaScript and XML) allows web pages to communicate with servers asynchronously, updating parts of a page without reloading the entire page.</p><div class='key-points-box'><p><strong>üîë Key Point:</strong> AJAX enables dynamic, responsive web applications by fetching data in the background and updating only relevant parts of the page.</p></div><h4>Traditional vs AJAX Request</h4><table style='width:100%; border-collapse: collapse; margin:15px 0;'><tr style='background-color:#2772a0; color:white;'><th style='padding:10px; border:1px solid #ddd;'>Aspect</th><th style='padding:10px; border:1px solid #ddd;'>Traditional Form Submit</th><th style='padding:10px; border:1px solid #ddd;'>AJAX Request</th></tr><tr><td style='padding:8px; border:1px solid #ddd;'>Page Reload</td><td style='padding:8px; border:1px solid #ddd;'>Full page reload</td><td style='padding:8px; border:1px solid #ddd;'>No reload, partial update</td></tr><tr><td style='padding:8px; border:1px solid #ddd;'>User Experience</td><td style='padding:8px; border:1px solid #ddd;'>Disruptive, flashing</td><td style='padding:8px; border:1px solid #ddd;'>Smooth, continuous</td></tr><tr><td style='padding:8px; border:1px solid #ddd;'>Data Transfer</td><td style='padding:8px; border:1px solid #ddd;'>Sends entire page</td><td style='padding:8px; border:1px solid #ddd;'>Sends only necessary data</td></tr><tr><td style='padding:8px; border:1px solid #ddd;'>Response</td><td style='padding:8px; border:1px solid #ddd;'>HTML page</td><td style='padding:8px; border:1px solid #ddd;'>JSON, XML, HTML fragment</td></tr></table><h4>AJAX with Fetch API (Modern)</h4><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>// GET request\nfetch('https://api.example.com/users/123')\n    .then(response => {\n        if (!response.ok) {\n            throw new Error('Network response was not ok');\n        }\n        return response.json();\n    })\n    .then(data => {\n        console.log('User data:', data);\n        document.getElementById('userName').textContent = data.name;\n        document.getElementById('userEmail').textContent = data.email;\n    })\n    .catch(error => {\n        console.error('Fetch error:', error);\n        document.getElementById('error').textContent = 'Failed to load user';\n    });\n\n// POST request with JSON\nconst userData = {\n    name: 'John Doe',\n    email: 'john@example.com',\n    age: 30\n};\n\nfetch('https://api.example.com/users', {\n    method: 'POST',\n    headers: {\n        'Content-Type': 'application/json'\n    },\n    body: JSON.stringify(userData)\n})\n.then(response => response.json())\n.then(data => {\n    console.log('User created:', data);\n    showSuccessMessage('User created successfully!');\n})\n.catch(error => {\n    console.error('Error:', error);\n    showErrorMessage('Failed to create user');\n});\n\n// Form data submission\nconst form = document.getElementById('myForm');\nform.addEventListener('submit', function(e) {\n    e.preventDefault();\n    \n    const formData = new FormData(form);\n    \n    fetch('/api/submit', {\n        method: 'POST',\n        body: formData\n    })\n    .then(response => response.json())\n    .then(data => {\n        if (data.success) {\n            document.getElementById('result').innerHTML = '&lt;div class=\"success\"&gt;' + data.message + '&lt;/div&gt;';\n        } else {\n            document.getElementById('result').innerHTML = '&lt;div class=\"error\"&gt;' + data.error + '&lt;/div&gt;';\n        }\n    });\n});</pre><h4>AJAX with XMLHttpRequest (Traditional)</h4><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>const xhr = new XMLHttpRequest();\nxhr.open('GET', 'https://api.example.com/data', true);\n\nxhr.onload = function() {\n    if (xhr.status === 200) {\n        const data = JSON.parse(xhr.responseText);\n        console.log('Data received:', data);\n        updatePage(data);\n    } else {\n        console.error('Request failed:', xhr.status);\n    }\n};\n\nxhr.onerror = function() {\n    console.error('Network error occurred');\n};\n\nxhr.send();</pre><h4>Loading Indicators and Error Handling</h4><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>function loadUserData(userId) {\n    // Show loading indicator\n    document.getElementById('loading').style.display = 'block';\n    document.getElementById('content').style.display = 'none';\n    document.getElementById('error').style.display = 'none';\n    \n    fetch(`/api/users/${userId}`)\n        .then(response => {\n            if (!response.ok) {\n                throw new Error('Server responded with ' + response.status);\n            }\n            return response.json();\n        })\n        .then(data => {\n            // Hide loading, show content\n            document.getElementById('loading').style.display = 'none';\n            document.getElementById('content').style.display = 'block';\n            \n            // Update UI with data\n            document.getElementById('userName').textContent = data.name;\n            document.getElementById('userEmail').textContent = data.email;\n        })\n        .catch(error => {\n            // Hide loading, show error\n            document.getElementById('loading').style.display = 'none';\n            document.getElementById('error').style.display = 'block';\n            document.getElementById('errorMessage').textContent = error.message;\n        });\n}</pre></div>",
                keyPoints: [
                    "AJAX enables asynchronous server communication without page reload",
                    "Fetch API is the modern standard for AJAX requests",
                    "Promises handle asynchronous operations (.then(), .catch())",
                    "Always handle errors and show loading states for better UX",
                    "JSON is the most common data format for AJAX responses"
                ]
            },

            {
                title: "2.5 Session Management and Cookies",
                content: "<div><h4>HTTP is Stateless</h4><p>HTTP is a stateless protocol, meaning each request is independent and the server doesn't retain information about previous requests. Session management techniques overcome this limitation.</p><h4>Cookies</h4><p>Cookies are small pieces of data stored in the browser and sent with every request to the same domain.</p><h5>Setting Cookies</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>// Client-side JavaScript\ndocument.cookie = \"username=John; expires=Fri, 31 Dec 2025 23:59:59 GMT; path=/\";\ndocument.cookie = \"theme=dark; max-age=86400; Secure; SameSite=Strict\";\n\n// Server-side (PHP)\nsetcookie(\"user_id\", \"123\", time() + 3600, \"/\", \"\", true, true);\n\n// Server-side (Node.js with Express)\nres.cookie('sessionId', 'abc123', {\n    maxAge: 3600000, // 1 hour\n    httpOnly: true,\n    secure: true,\n    sameSite: 'strict'\n});</pre><h5>Reading Cookies</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>// Client-side JavaScript\nfunction getCookie(name) {\n    const value = \"; \" + document.cookie;\n    const parts = value.split(\"; \" + name + \"=\");\n    if (parts.length === 2) return parts.pop().split(\";\").shift();\n}\n\nconst username = getCookie('username');\n\n// Server-side (PHP)\n$username = $_COOKIE['username'] ?? '';\n\n// Server-side (Node.js)\nconst sessionId = req.cookies.sessionId;</pre><h4>Session Management</h4><p>Sessions store user data on the server, with only a session ID stored in a cookie on the client.</p><h5>PHP Sessions</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>&lt;?php\n// Start session\nsession_start();\n\n// Store data in session\n$_SESSION['user_id'] = 123;\n$_SESSION['username'] = 'john_doe';\n$_SESSION['cart'] = ['item1', 'item2'];\n\n// Check if user is logged in\nif (isset($_SESSION['user_id'])) {\n    echo \"Welcome back, \" . $_SESSION['username'];\n} else {\n    echo \"Please log in\";\n}\n\n// Destroy session on logout\nsession_destroy();\n?&gt;</pre><h5>Node.js with Express Session</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>const express = require('express');\nconst session = require('express-session');\nconst app = express();\n\napp.use(session({\n    secret: 'your-secret-key',\n    resave: false,\n    saveUninitialized: true,\n    cookie: { \n        secure: true,        // HTTPS only\n        maxAge: 3600000,      // 1 hour\n        httpOnly: true        // Prevent XSS access\n    }\n}));\n\n// Store data in session\napp.post('/login', (req, res) => {\n    req.session.userId = 123;\n    req.session.username = 'john_doe';\n    res.send('Logged in');\n});\n\n// Access session data\napp.get('/profile', (req, res) => {\n    if (req.session.userId) {\n        res.json({\n            userId: req.session.userId,\n            username: req.session.username\n        });\n    } else {\n        res.status(401).send('Not authenticated');\n    }\n});\n\n// Destroy session\napp.post('/logout', (req, res) => {\n    req.session.destroy();\n    res.send('Logged out');\n});</pre><h5>Local Storage (HTML5)</h5><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>// Store data (persists until cleared)\nlocalStorage.setItem('theme', 'dark');\nlocalStorage.setItem('preferences', JSON.stringify({ fontSize: 'large', notifications: true }));\n\n// Retrieve data\nconst theme = localStorage.getItem('theme');\nconst prefs = JSON.parse(localStorage.getItem('preferences'));\n\n// Remove item\nlocalStorage.removeItem('theme');\n\n// Clear all\nlocalStorage.clear();\n\n// Session storage (cleared when browser closed)\nsessionStorage.setItem('tempData', 'some value');</pre><div class='key-points-box'><p><strong>üîë Important:</strong> Cookies are sent with every request (bandwidth overhead). Sessions store data on server (more secure). Local storage is client-only (5-10MB capacity). Choose based on security needs and data size.</p></div></div>",
                keyPoints: [
                    "HTTP is stateless - sessions and cookies add state",
                    "Cookies stored on client, sent with every request (limited to 4KB)",
                    "Sessions store data on server, only session ID in cookie",
                    "Local storage (5-10MB) and session storage for client-side only",
                    "Use httpOnly and secure flags for sensitive cookies",
                    "Always validate session data on server side"
                ]
            },

            {
                title: "2.6 Practical Application: Building an Interactive Form",
                content: "<div><h4>Blueprint Focus: Apply - Complete Example</h4><p>This section combines all concepts to build a complete interactive registration form with:</p><ul><li>Client-side validation with real-time feedback</li><li>AJAX form submission</li><li>Server-side processing (Node.js example)</li><li>Session management for user login</li></ul><h4>HTML Structure</h4><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n    &lt;title&gt;Registration Form&lt;/title&gt;\n    &lt;style&gt;\n        .form-group { margin-bottom: 15px; }\n        label { display: block; margin-bottom: 5px; font-weight: bold; }\n        input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }\n        input.error { border-color: red; }\n        .error-message { color: red; font-size: 12px; margin-top: 5px; display: none; }\n        .success-message { color: green; font-size: 14px; margin-top: 10px; display: none; }\n        .loading { display: none; text-align: center; }\n        button { padding: 10px 20px; background: #2772a0; color: white; border: none; border-radius: 4px; cursor: pointer; }\n        button:disabled { opacity: 0.5; cursor: not-allowed; }\n    &lt;/style&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;div class=\"container\"&gt;\n        &lt;h2&gt;Registration Form&lt;/h2&gt;\n        \n        &lt;form id=\"registrationForm\"&gt;\n            &lt;div class=\"form-group\"&gt;\n                &lt;label for=\"username\"&gt;Username:&lt;/label&gt;\n                &lt;input type=\"text\" id=\"username\" name=\"username\" required minlength=\"3\"&gt;\n                &lt;div class=\"error-message\" id=\"usernameError\"&gt;&lt;/div&gt;\n            &lt;/div&gt;\n            \n            &lt;div class=\"form-group\"&gt;\n                &lt;label for=\"email\"&gt;Email:&lt;/label&gt;\n                &lt;input type=\"email\" id=\"email\" name=\"email\" required&gt;\n                &lt;div class=\"error-message\" id=\"emailError\"&gt;&lt;/div&gt;\n            &lt;/div&gt;\n            \n            &lt;div class=\"form-group\"&gt;\n                &lt;label for=\"password\"&gt;Password:&lt;/label&gt;\n                &lt;input type=\"password\" id=\"password\" name=\"password\" required&gt;\n                &lt;div class=\"error-message\" id=\"passwordError\"&gt;&lt;/div&gt;\n            &lt;/div&gt;\n            \n            &lt;div class=\"form-group\"&gt;\n                &lt;label for=\"confirmPassword\"&gt;Confirm Password:&lt;/label&gt;\n                &lt;input type=\"password\" id=\"confirmPassword\" name=\"confirmPassword\" required&gt;\n                &lt;div class=\"error-message\" id=\"confirmPasswordError\"&gt;&lt;/div&gt;\n            &lt;/div&gt;\n            \n            &lt;div class=\"loading\" id=\"loading\"&gt;\n                &lt;img src=\"spinner.gif\" alt=\"Loading...\"&gt;\n            &lt;/div&gt;\n            \n            &lt;div class=\"success-message\" id=\"successMessage\"&gt;&lt;/div&gt;\n            \n            &lt;button type=\"submit\" id=\"submitBtn\"&gt;Register&lt;/button&gt;\n        &lt;/form&gt;\n    &lt;/div&gt;\n    \n    &lt;script src=\"registration.js\"&gt;&lt;/script&gt;\n&lt;/body&gt;\n&lt;/html&gt;</pre><h4>JavaScript (registration.js) - Client-Side</h4><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>document.addEventListener('DOMContentLoaded', function() {\n    const form = document.getElementById('registrationForm');\n    const submitBtn = document.getElementById('submitBtn');\n    const loading = document.getElementById('loading');\n    const successMessage = document.getElementById('successMessage');\n    \n    // Real-time validation\n    document.getElementById('username').addEventListener('input', validateUsername);\n    document.getElementById('email').addEventListener('input', validateEmail);\n    document.getElementById('password').addEventListener('input', validatePassword);\n    document.getElementById('confirmPassword').addEventListener('input', validateConfirmPassword);\n    \n    function validateUsername() {\n        const username = document.getElementById('username');\n        const error = document.getElementById('usernameError');\n        \n        if (username.value.length < 3) {\n            showError(username, error, 'Username must be at least 3 characters');\n            return false;\n        } else {\n            hideError(username, error);\n            return true;\n        }\n    }\n    \n    function validateEmail() {\n        const email = document.getElementById('email');\n        const error = document.getElementById('emailError');\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        \n        if (!emailRegex.test(email.value)) {\n            showError(email, error, 'Please enter a valid email address');\n            return false;\n        } else {\n            hideError(email, error);\n            return true;\n        }\n    }\n    \n    function validatePassword() {\n        const password = document.getElementById('password');\n        const error = document.getElementById('passwordError');\n        const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d).{8,}$/;\n        \n        if (!passwordRegex.test(password.value)) {\n            showError(password, error, 'Password must be at least 8 characters with uppercase, lowercase, and number');\n            return false;\n        } else {\n            hideError(password, error);\n            return true;\n        }\n    }\n    \n    function validateConfirmPassword() {\n        const confirmPassword = document.getElementById('confirmPassword');\n        const password = document.getElementById('password');\n        const error = document.getElementById('confirmPasswordError');\n        \n        if (confirmPassword.value !== password.value) {\n            showError(confirmPassword, error, 'Passwords do not match');\n            return false;\n        } else {\n            hideError(confirmPassword, error);\n            return true;\n        }\n    }\n    \n    function showError(input, errorElement, message) {\n        input.classList.add('error');\n        errorElement.textContent = message;\n        errorElement.style.display = 'block';\n    }\n    \n    function hideError(input, errorElement) {\n        input.classList.remove('error');\n        errorElement.style.display = 'none';\n    }\n    \n    // Form submission\n    form.addEventListener('submit', async function(e) {\n        e.preventDefault();\n        \n        // Validate all fields\n        const isUsernameValid = validateUsername();\n        const isEmailValid = validateEmail();\n        const isPasswordValid = validatePassword();\n        const isConfirmValid = validateConfirmPassword();\n        \n        if (isUsernameValid && isEmailValid && isPasswordValid && isConfirmValid) {\n            // Show loading, disable button\n            loading.style.display = 'block';\n            submitBtn.disabled = true;\n            successMessage.style.display = 'none';\n            \n            // Prepare form data\n            const formData = new FormData(form);\n            const data = {\n                username: formData.get('username'),\n                email: formData.get('email'),\n                password: formData.get('password')\n            };\n            \n            try {\n                const response = await fetch('/api/register', {\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json'\n                    },\n                    body: JSON.stringify(data)\n                });\n                \n                const result = await response.json();\n                \n                if (response.ok) {\n                    successMessage.textContent = 'Registration successful! Redirecting to login...';\n                    successMessage.style.display = 'block';\n                    \n                    // Clear form\n                    form.reset();\n                    \n                    // Redirect after 2 seconds\n                    setTimeout(() => {\n                        window.location.href = '/login';\n                    }, 2000);\n                } else {\n                    alert('Registration failed: ' + result.error);\n                }\n            } catch (error) {\n                alert('Network error. Please try again.');\n                console.error('Error:', error);\n            } finally {\n                loading.style.display = 'none';\n                submitBtn.disabled = false;\n            }\n        }\n    });\n});</pre><h4>Server-Side (Node.js - server.js)</h4><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>const express = require('express');\nconst bcrypt = require('bcrypt');\nconst session = require('express-session');\nconst app = express();\n\napp.use(express.json());\napp.use(express.static('public'));\n\napp.use(session({\n    secret: 'your-secret-key',\n    resave: false,\n    saveUninitialized: true,\n    cookie: { secure: false, httpOnly: true, maxAge: 3600000 }\n}));\n\n// Mock database (replace with real database)\nconst users = [];\n\n// Registration endpoint\napp.post('/api/register', async (req, res) => {\n    const { username, email, password } = req.body;\n    \n    // Server-side validation\n    if (!username || username.length < 3) {\n        return res.status(400).json({ error: 'Username must be at least 3 characters' });\n    }\n    \n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    if (!emailRegex.test(email)) {\n        return res.status(400).json({ error: 'Invalid email format' });\n    }\n    \n    const passwordRegex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d).{8,}$/;\n    if (!passwordRegex.test(password)) {\n        return res.status(400).json({ error: 'Password does not meet requirements' });\n    }\n    \n    // Check if user exists\n    if (users.find(u => u.email === email)) {\n        return res.status(400).json({ error: 'Email already registered' });\n    }\n    \n    // Hash password\n    const hashedPassword = await bcrypt.hash(password, 10);\n    \n    // Save user\n    const newUser = {\n        id: users.length + 1,\n        username,\n        email,\n        password: hashedPassword,\n        createdAt: new Date()\n    };\n    \n    users.push(newUser);\n    \n    res.status(201).json({ message: 'Registration successful' });\n});\n\n// Login endpoint\napp.post('/api/login', async (req, res) => {\n    const { email, password } = req.body;\n    \n    const user = users.find(u => u.email === email);\n    \n    if (!user) {\n        return res.status(401).json({ error: 'Invalid credentials' });\n    }\n    \n    const validPassword = await bcrypt.compare(password, user.password);\n    \n    if (!validPassword) {\n        return res.status(401).json({ error: 'Invalid credentials' });\n    }\n    \n    // Set session\n    req.session.userId = user.id;\n    req.session.username = user.username;\n    \n    res.json({ message: 'Login successful', user: { id: user.id, username: user.username, email: user.email } });\n});\n\n// Profile endpoint (protected)\napp.get('/api/profile', (req, res) => {\n    if (!req.session.userId) {\n        return res.status(401).json({ error: 'Not authenticated' });\n    }\n    \n    const user = users.find(u => u.id === req.session.userId);\n    \n    if (!user) {\n        return res.status(404).json({ error: 'User not found' });\n    }\n    \n    res.json({\n        id: user.id,\n        username: user.username,\n        email: user.email,\n        createdAt: user.createdAt\n    });\n});\n\n// Logout endpoint\napp.post('/api/logout', (req, res) => {\n    req.session.destroy();\n    res.json({ message: 'Logged out' });\n});\n\napp.listen(3000, () => {\n    console.log('Server running on port 3000');\n});</pre><div class='example-box'><h4><i class='fas fa-lightbulb'></i> Apply Exercise:</h4><p><strong>Task:</strong> Modify the registration form to include:</p><ol><li>A 'Show Password' checkbox that toggles password visibility</li><li>Password strength indicator (weak, medium, strong)</li><li>Real-time username availability check via AJAX</li><li>Remember me functionality using localStorage</li></ol></div></div>",
                keyPoints: [
                    "Combine client-side validation, AJAX, and server-side processing",
                    "Real-time validation improves user experience",
                    "Always validate on server side regardless of client validation",
                    "Use loading states during AJAX requests",
                    "Hash passwords before storing (bcrypt recommended)",
                    "Sessions maintain user login state"
                ]
            }
        ],

        keyPoints: [
            "Server-side languages: PHP, Node.js, Python, Java, Ruby, C#",
            "Client-side JavaScript enables DOM manipulation and event handling",
            "Form validation must happen on both client and server",
            "AJAX enables asynchronous server communication without page reload",
            "Fetch API is modern standard for AJAX requests",
            "Sessions and cookies maintain state across HTTP requests",
            "Always hash passwords and use HTTPS for security"
        ],

        summary: "<h3>Chapter 2 Summary - Key Takeaways:</h3><ul><li><strong>Server-Side Scripting:</strong> PHP, Node.js, Python generate dynamic content, access databases, handle authentication</li><li><strong>Client-Side JavaScript:</strong> DOM manipulation, event handling, immediate user feedback</li><li><strong>Form Handling:</strong> HTML5 validation + JavaScript validation + Server validation (never trust client!)</li><li><strong>AJAX:</strong> Fetch API for asynchronous requests, loading states, error handling</li><li><strong>State Management:</strong> Cookies (client, 4KB), Sessions (server), LocalStorage (client, 5-10MB)</li><li><strong>Security:</strong> Validate all inputs, hash passwords, use HTTPS, httpOnly cookies</li></ul>",

        reviewQuestions: [
            {
                question: "Compare and contrast server-side and client-side scripting. When would you use each?",
                answer: "Client-side (JavaScript) runs in browser for immediate interactivity, UI updates, and validation. Server-side runs on server for database access, authentication, business logic, and security-critical operations. Modern apps use both: client-side for UX, server-side for security and data."
            },
            {
                question: "Explain the difference between cookies, sessions, and localStorage. When would you use each?",
                answer: "Cookies: small (4KB), sent with every request, good for session IDs. Sessions: data stored on server, only ID in cookie, secure for user data. localStorage: larger (5-10MB), client-only, good for user preferences, cache. Use sessions for sensitive data, localStorage for non-sensitive client data, cookies for cross-request identification."
            },
            {
                question: "Why is server-side validation necessary even when client-side validation is implemented?",
                answer: "Client-side validation can be bypassed (disable JavaScript, modify requests). Server-side validation is the last line of defense against malicious input, SQL injection, XSS attacks. Always validate on server regardless of client validation."
            },
            {
                question: "Write JavaScript code to make an AJAX POST request using the Fetch API with JSON data.",
                answer: "fetch('/api/users', { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({ name: 'John', email: 'john@example.com' }) }).then(response => response.json()).then(data => console.log(data)).catch(error => console.error(error));"
            },
            {
                question: "What is the purpose of the httpOnly flag in cookies? Why is it important?",
                answer: "httpOnly flag prevents JavaScript from accessing cookies, protecting against XSS attacks. Even if an attacker injects malicious script, they cannot steal session cookies. Essential for security in production applications."
            }
        ],

        quickTips: [
            "Always validate on server - never trust client input",
            "Use async/await with fetch for cleaner AJAX code",
            "Hash passwords with bcrypt, never store plain text",
            "Set httpOnly and secure flags on session cookies",
            "Show loading indicators during AJAX requests",
            "Use localStorage for user preferences, not sensitive data",
            "Implement real-time validation for better UX"
        ],

        commonMistakes: [
            "‚ùå Only validating on client side (security risk)",
            "‚ùå Storing passwords in plain text",
            "‚ùå Not sanitizing user input (XSS, SQL injection)",
            "‚ùå Exposing sensitive data in localStorage",
            "‚ùå Forgetting to handle AJAX errors",
            "‚ùå Not using httpOnly cookies for sessions",
            "‚ùå Overusing cookies (bandwidth overhead)"
        ],

        examPreparation: "<h3>Blueprint Alignment for Chapter 2:</h3><p>This chapter has <strong>2 questions</strong> at the <strong>Apply</strong> level.</p><h4>What 'Apply' Means:</h4><p>You need to implement solutions using server-side scripting and client-side interactivity. Questions will require you to:</p><ul><li>Write server-side code to process form data</li><li>Implement client-side validation and feedback</li><li>Create AJAX requests for asynchronous operations</li><li>Manage sessions and cookies</li><li>Apply security best practices</li></ul><h4>Expected Question Types:</h4><ol><li><strong>Code Implementation:</strong> Write server-side script to handle form submission</li><li><strong>AJAX Implementation:</strong> Create fetch request with error handling</li><li><strong>Validation Implementation:</strong> Implement client and server validation</li><li><strong>Session Management:</strong> Implement login/logout with sessions</li></ol><h4>Sample Apply Question:</h4><div style='background:#f8f9fa; padding:20px; border-radius:10px; margin:20px 0;'><p><strong>Question:</strong> Write a PHP script that processes a login form. The script should:</p><ul><li>Validate that email and password are provided</li><li>Check credentials against a MySQL database</li><li>Start a session on successful login</li><li>Return appropriate JSON responses for AJAX</li></ul><p><strong>Expected Answer:</strong></p><pre style='background:#2d2d2d; color:#f8f8f2; padding:15px; border-radius:5px;'>&lt;?php\nsession_start();\nheader('Content-Type: application/json');\n\nif ($_SERVER['REQUEST_METHOD'] !== 'POST') {\n    echo json_encode(['success' => false, 'error' => 'Method not allowed']);\n    exit;\n}\n\n$email = $_POST['email'] ?? '';\n$password = $_POST['password'] ?? '';\n\nif (empty($email) || empty($password)) {\n    echo json_encode(['success' => false, 'error' => 'Email and password required']);\n    exit;\n}\n\n$pdo = new PDO('mysql:host=localhost;dbname=mydb', 'user', 'password');\n$stmt = $pdo->prepare('SELECT id, username, password FROM users WHERE email = ?');\n$stmt->execute([$email]);\n$user = $stmt->fetch();\n\nif ($user && password_verify($password, $user['password'])) {\n    $_SESSION['user_id'] = $user['id'];\n    $_SESSION['username'] = $user['username'];\n    \n    echo json_encode([\n        'success' => true,\n        'message' => 'Login successful',\n        'user' => ['id' => $user['id'], 'username' => $user['username']]\n    ]);\n} else {\n    echo json_encode(['success' => false, 'error' => 'Invalid credentials']);\n}\n?&gt;</pre></div>"
    };

    console.log("‚úÖ Chapter 2 object assigned successfully!");
    console.log("window.focusAreaWebChapter2:", window.focusAreaWebChapter2 ? "Exists" : "Missing");
})();