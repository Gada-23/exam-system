<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Exam System - Computer Science Exit Exam</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><defs><linearGradient id='grad' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' style='stop-color:%232772a0;stop-opacity:1' /><stop offset='100%' style='stop-color:%23ccddea;stop-opacity:1' /></linearGradient></defs><rect width='100' height='100' fill='url(%23grad)' rx='15'/><path d='M25 30 L25 75 Q25 80 30 80 L70 80 Q75 80 75 75 L75 30 Q75 25 70 25 L30 25 Q25 25 25 30' fill='white' opacity='0.9'/><path d='M45 35 L45 70' stroke='%232772a0' stroke-width='2' fill='none'/><circle cx='35' cy='45' r='3' fill='%232772a0'/><circle cx='55' cy='45' r='3' fill='%232772a0'/><circle cx='35' cy='58' r='3' fill='%23ccddea'/><circle cx='55' cy='58' r='3' fill='%23ccddea'/><path d='M40 20 L35 15 L30 20 L32 25 L38 25 Z' fill='white' stroke='%23ccddea' stroke-width='1.5'/></svg>">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- COURSE SELECTION MODAL -->
<div id="courseModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2><i class="fas fa-graduation-cap"></i> Select Exam Mode</h2>
            <p class="modal-subtitle">Choose how you want to practice for your Computer Science Exit Exam</p>
        </div>
        
        <div class="modal-body">
            <!-- Comprehensive Mode (100 Random Questions) -->
            <div class="mode-card" id="randomModeCard">
                <div class="mode-icon">
                    <i class="fas fa-random"></i>
                </div>
                <h3>Comprehensive Mode</h3>
                <p>100 random questions from ALL courses</p>
                <div class="mode-badge" id="totalQuestionsCount">Loading...</div>
            </div>

            <div class="divider">
                <span>OR</span>
            </div>

            <!-- Previous Exams Section -->
            <div class="course-selection">
                <h4><i class="fas fa-history"></i> Previous Exit Exams</h4>
                
                <div class="previous-exam-grid" id="previousExamGrid">
                    <div class="exam-card" data-year="2016" id="exam2016Card">
                        <div class="exam-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="exam-info">
                            <h4>2016 Exit Exam</h4>
                            <span class="exam-count">100 Questions</span>
                        </div>
                    </div>
                    <!-- 2017 EXAM CARD -->
                    <div class="exam-card" data-year="2017" id="exam2017Card">
                        <div class="exam-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="exam-info">
                            <h4>2017 Exit Exam</h4>
                            <span class="exam-count">100 Questions</span>
                        </div>
                    </div>
                    <!-- Add more years as they become available -->
                    <!--
                    <div class="exam-card" data-year="2018" id="exam2018Card">
                        <div class="exam-icon">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="exam-info">
                            <h4>2018 Exit Exam</h4>
                            <span class="exam-count">100 Questions</span>
                        </div>
                    </div>
                    -->
                </div>
                
                <div class="course-note">
                    <i class="fas fa-info-circle"></i>
                    <span>Practice with actual previous exit exam questions to familiarize yourself with the exam format.</span>
                </div>
            </div>

            <div class="divider">
                <span>OR</span>
            </div>

            <!-- Course Selection -->
            <div class="course-selection">
                <h4><i class="fas fa-filter"></i> Focus on Specific Course</h4>
                
                <!-- Total Stats -->
                <div class="total-stats" id="totalStats">
                    <div class="loading-courses" style="padding: 10px;">
                        <i class="fas fa-circle-notch"></i>
                        <p>Loading stats...</p>
                    </div>
                </div>
                
                <div class="course-grid" id="courseGrid">
                    <div class="loading-courses">
                        <i class="fas fa-circle-notch"></i>
                        <p>Loading courses...</p>
                    </div>
                </div>
                
                <!-- Selected Course Info (hidden initially) -->
                <div id="selectedCourseInfo" class="selected-course-info" style="display: none;">
                    <div class="selected-course-name">
                        <i class="fas fa-book-open"></i>
                        <span id="selectedCourseName"></span>
                    </div>
                    <div class="selected-course-stats">
                        <span><i class="fas fa-question-circle"></i> <span id="selectedCourseTotal">0</span> available</span>
                    </div>
                </div>
                
                <!-- Question Quantity Selection (hidden initially) -->
                <div id="quantitySection" class="quantity-section" style="display: none;">
                    <h5><i class="fas fa-sliders-h"></i> Number of Questions:</h5>
                    <div class="quantity-options" id="quantityOptions">
                        <div class="quantity-option" data-quantity="10">10</div>
                        <div class="quantity-option" data-quantity="20">20</div>
                        <div class="quantity-option" data-quantity="30">30</div>
                        <div class="quantity-option" data-quantity="40">40</div>
                        <div class="quantity-option" data-quantity="50">50</div>
                    </div>
                    <div class="quantity-note">
                        <i class="fas fa-info-circle"></i>
                        <span>Select how many questions you want to practice</span>
                    </div>
                </div>
                
                <div class="course-note">
                    <i class="fas fa-info-circle"></i>
                    <span>Select a course to practice specific topics, then choose the number of questions (max available).</span>
                </div>
            </div>
        </div>

        <div class="modal-footer">
            <button id="startSelectedBtn" class="btn-primary" disabled>
                <i class="fas fa-play"></i> Start Exam
            </button>
            <button id="cancelModalBtn" class="btn-secondary">
                <i class="fas fa-times"></i> Cancel
            </button>
        </div>
    </div>
</div>

<!-- HOME -->
<section id="home" class="page active">
    <div class="home-container">
        <div class="floating-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
        </div>
        <div class="card card-home">
            <div class="home-icon">
                <i class="fas fa-laptop-code"></i>
            </div>
            <h1>Computer Science Exit Exam Practice</h1>
            <p class="subtitle">Master all courses with our comprehensive exam preparation platform</p>
            
            <div class="features">
                <div class="feature-item">
                    <i class="fas fa-database"></i>
                    <span id="totalQuestionsFeature">Loading...</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-book"></i>
                    <span id="totalCoursesFeature">Loading...</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-clock"></i>
                    <span>2 Hours</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-history"></i>
                    <span>Previous Exams</span>
                </div>
            </div>
            
            <div class="action-buttons">
                <button id="startBtn" class="action-btn exam">
                    <i class="fas fa-play"></i> 
                    <span class="btn-text">Start Exam</span>
                    <span class="btn-subtext">Test your knowledge</span>
                </button>
                <a href="study.html" class="action-btn study">
                    <i class="fas fa-book-open"></i> 
                    <span class="btn-text">Study Materials</span>
                    <span class="btn-subtext">Learn the concepts</span>
                </a>
            </div>
            
            <div class="home-stats" id="homeStats">
                <!-- Stats will be populated by JavaScript -->
            </div>
            
            <div style="margin-top: 25px;">
                <a href="about-developer.html" class="about-link">
                    <i class="fas fa-user-circle"></i> About Developer
                </a>
            </div>
        </div>
    </div>
</section>

<!-- EXAM -->
<section id="exam" class="page">
    <div class="exam-container">
        <div class="exam-header">
            <div class="header-left">
                <h2><i class="fas fa-clipboard-list"></i> <span id="examModeTitle">Exam in Progress</span></h2>
                <div class="progress-info" id="progress"></div>
            </div>
            <div class="header-right">
                <div class="timer-box" id="timer">02:00:00</div>
            </div>
        </div>

        <!-- Main content area with question and navigator side by side -->
        <div class="exam-main-content">
            <!-- Left side: Question Area -->
            <div class="question-area">
                <div class="question-header">
                    <h3>Question <span id="currentQNum">1</span> of <span id="totalQCount">0</span></h3>
                </div>
                <div id="questionBox" class="question-card"></div>
                
                <!-- Navigation Buttons - Now placed below the question -->
                <div class="question-navigation-buttons">
                    <button id="prevBtn" class="btn-secondary">
                        <i class="fas fa-chevron-left"></i> < Previous
                    </button>
                    <button id="checkAnswerBtn" class="btn-primary check-btn" disabled>
                        <i class="fas fa-check"></i> Check Answer
                    </button>
                    <button id="nextBtn" class="btn-secondary">
                        Next > <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>

            <!-- Right side: Question Navigator -->
            <div class="navigator-sidebar">
                <div class="question-navigator-container">
                    <h3><i class="fas fa-th"></i> Question Navigator</h3>
                    <div class="question-navigator" id="questionNavigator">
                        <!-- Grid will be populated by JavaScript -->
                    </div>
                    <p class="navigator-hint">Click any number to jump to that question</p>
                </div>
            </div>
        </div>

        <!-- Submit Button at bottom (outside the flex container) -->
        <div class="submit-section">
            <button id="submitBtn" class="btn-danger">
                <i class="fas fa-paper-plane"></i> Submit Exam
            </button>
        </div>
    </div>
</section>

<!-- RESULT -->
<section id="result" class="page">
    <div class="result-container">
        <div class="result-card">
            <div class="result-icon">
                <i class="fas fa-trophy"></i>
            </div>
            <h2>Exam Completed!</h2>
            <div class="score-display" id="scoreText"></div>
            <div class="result-buttons">
                <button id="reviewBtn" class="btn-primary">
                    <i class="fas fa-redo"></i> Review Questions
                </button>
                <button onclick="location.reload()" class="btn-secondary">
                    <i class="fas fa-home"></i> Go Home
                </button>
            </div>
        </div>
    </div>
</section>

<!-- REVIEW -->
<section id="review" class="page">
    <div class="review-container">
        <h2><i class="fas fa-list-check"></i> Review Your Answers</h2>
        <div id="reviewContainer" class="review-content"></div>
        <div class="review-footer">
            <button onclick="location.reload()" class="btn-primary">
                <i class="fas fa-home"></i> Finish & Go Home
            </button>
        </div>
    </div>
</section>

<!-- Add this right before the questions.js script -->
<script>
// Store questions in session storage when leaving the page
window.addEventListener('beforeunload', function() {
    if (window.allQuestions && window.allQuestions.length > 0) {
        sessionStorage.setItem('cachedQuestions', JSON.stringify({
            timestamp: Date.now(),
            questions: window.allQuestions
        }));
    }
});

// Check for cached questions on load
(function() {
    const cached = sessionStorage.getItem('cachedQuestions');
    if (cached) {
        try {
            const data = JSON.parse(cached);
            // Only use cache if less than 5 minutes old
            if (Date.now() - data.timestamp < 300000) {
                window.allQuestions = data.questions;
                window.questionsLoaded = true;
                console.log('Loaded questions from session cache');
            } else {
                sessionStorage.removeItem('cachedQuestions');
            }
        } catch (e) {
            console.warn('Failed to parse cached questions');
            sessionStorage.removeItem('cachedQuestions');
        }
    }
})();
</script>

<!-- IMPORTANT: questions first -->
<script src="questions.js"></script>
<script src="script.js"></script>

<!-- Updated verification on load (console only) -->
<script>
    setTimeout(function() {
        console.log("=== VERIFICATION ===");
        console.log("allQuestions exists:", typeof allQuestions !== 'undefined');
        if (typeof allQuestions !== 'undefined') {
            console.log("Total questions:", allQuestions.length);
            
            // Define the 15 main courses with exact names matching the questions
            const mainCourses = [
                'Computer Programming',
                'Database Systems',
                'Object Oriented Programming',
                'Computer Organization & Architecture',
                'Data Communication & Networking',
                'Data Structures & Algorithms',
                'Web Programming',
                'Operating System',
                'Software Engineering',
                'Design & Analysis of Algorithms',
                'Artificial Intelligence',
                'Computer Security',
                'Network and System Administration', // Fixed: Changed from 'Network & System Administration' to match actual course name
                'Automata & Complexity Theory',
                'Compiler Design'
            ];
            
            // Count how many main courses have questions
            const coursesWithQuestions = mainCourses.filter(course => 
                allQuestions.some(q => q.course === course)
            );
            
            console.log("Main courses with questions:", coursesWithQuestions.length);
            console.log("Expected courses: 15");
            
            if (coursesWithQuestions.length === 15) {
                console.log("âœ… All 15 courses loaded successfully!");
            } else {
                console.warn(`âš ï¸ Only ${coursesWithQuestions.length} out of 15 courses have questions`);
                console.log("Missing courses:", mainCourses.filter(c => !coursesWithQuestions.includes(c)));
            }
            
            // Also check by alternative name formats
            const networkCourses = allQuestions.filter(q => 
                q.course && q.course.includes('Network')
            );
            if (networkCourses.length > 0) {
                console.log(`ðŸ“Š Network courses found: ${networkCourses.length} questions with course name: "${networkCourses[0].course}"`);
            }
            
            // Check if previous exams are loaded
            const exam2016Count = allQuestions.filter(q => q.year === 2016).length;
            const exam2017Count = allQuestions.filter(q => q.year === 2017).length;
            
            console.log(`ðŸ“… 2016 Exam: ${exam2016Count} questions`);
            console.log(`ðŸ“… 2017 Exam: ${exam2017Count} questions`);
            
            // Log total including previous exams
            console.log(`ðŸ“š Total questions (including previous exams): ${allQuestions.length}`);
            
            // Show top 5 courses by question count
            const courseCounts = {};
            allQuestions.forEach(q => {
                if (q.course) {
                    courseCounts[q.course] = (courseCounts[q.course] || 0) + 1;
                }
            });
            console.log("ðŸ“Š Top courses by question count:", Object.entries(courseCounts)
                .sort((a,b) => b[1] - a[1])
                .slice(0, 5)
                .map(([course, count]) => `${course}: ${count}`)
                .join(', '));
        }
        console.log("===================");
        
        // Update feature counts to show only 15 courses
        if (typeof allQuestions !== 'undefined') {
            const totalQuestions = document.getElementById('totalQuestionsFeature');
            const totalCourses = document.getElementById('totalCoursesFeature');
            
            if (totalQuestions) totalQuestions.textContent = allQuestions.length + ' Questions';
            if (totalCourses) totalCourses.textContent = '15 Courses'; // Fixed to 15
        }
    }, 1000);
</script>

</body>
</html>